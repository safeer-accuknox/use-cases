[{"check_type": "terraform", "results": {"failed_checks": [{"check_id": "CKV_AWS_56", "bc_check_id": "BC_AWS_S3_22", "check_name": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": null, "file_path": "/terraform/main.tf", "file_abs_path": "/code/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [19, 26], "resource": "aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22", "details": [], "check_len": null, "definition_context_file_path": "/code/terraform/main.tf"}, {"check_id": "CKV_AWS_53", "bc_check_id": "BC_AWS_S3_19", "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["block_public_acls"]}, "code_block": null, "file_path": "/terraform/main.tf", "file_abs_path": "/code/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [19, 26], "resource": "aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19", "details": [], "check_len": null, "definition_context_file_path": "/code/terraform/main.tf"}, {"check_id": "CKV_AWS_54", "bc_check_id": "BC_AWS_S3_20", "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["block_public_policy"]}, "code_block": null, "file_path": "/terraform/main.tf", "file_abs_path": "/code/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [19, 26], "resource": "aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20", "details": [], "check_len": null, "definition_context_file_path": "/code/terraform/main.tf"}, {"check_id": "CKV_AWS_55", "bc_check_id": "BC_AWS_S3_21", "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": null, "file_path": "/terraform/main.tf", "file_abs_path": "/code/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [19, 26], "resource": "aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21", "details": [], "check_len": null, "definition_context_file_path": "/code/terraform/main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 17, "__start_line__": 15, "bucket": ["my-unique-bucket-name"], "__address__": "aws_s3_bucket.this"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": null, "file_path": "/terraform/main.tf", "file_abs_path": "/code/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [15, 17], "resource": "aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "/code/terraform/main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 17, "__start_line__": 15, "bucket": ["my-unique-bucket-name"], "__address__": "aws_s3_bucket.this"}}}, "evaluated_keys": ["resource_type", "lifecycle_rule"]}, "code_block": null, "file_path": "/terraform/main.tf", "file_abs_path": "/code/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [15, 17], "resource": "aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "/code/terraform/main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 17, "__start_line__": 15, "bucket": ["my-unique-bucket-name"], "__address__": "aws_s3_bucket.this"}}}, "evaluated_keys": ["rule/*/status", "resource_type", "replication_configuration/rules/*/status"]}, "code_block": null, "file_path": "/terraform/main.tf", "file_abs_path": "/code/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [15, 17], "resource": "aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "/code/terraform/main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 17, "__start_line__": 15, "bucket": ["my-unique-bucket-name"], "__address__": "aws_s3_bucket.this"}}}, "evaluated_keys": ["server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": null, "file_path": "/terraform/main.tf", "file_abs_path": "/code/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [15, 17], "resource": "aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "/code/terraform/main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 17, "__start_line__": 15, "bucket": ["my-unique-bucket-name"], "__address__": "aws_s3_bucket.this"}}}, "evaluated_keys": ["versioning/enabled", "resource_type", "versioning_configuration/status"]}, "code_block": null, "file_path": "/terraform/main.tf", "file_abs_path": "/code/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [15, 17], "resource": "aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "/code/terraform/main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 17, "__start_line__": 15, "bucket": ["my-unique-bucket-name"], "__address__": "aws_s3_bucket.this"}}}, "evaluated_keys": ["block_public_policy", "resource_type", "block_public_acls"]}, "code_block": null, "file_path": "/terraform/main.tf", "file_abs_path": "/code/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [15, 17], "resource": "aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "/code/terraform/main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 17, "__start_line__": 15, "bucket": ["my-unique-bucket-name"], "__address__": "aws_s3_bucket.this"}}}, "evaluated_keys": ["resource_type"]}, "code_block": null, "file_path": "/terraform/main.tf", "file_abs_path": "/code/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [15, 17], "resource": "aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "/code/terraform/main.tf"}]}, "summary": {"passed": 5, "failed": 11, "skipped": 0, "parsing_errors": 0, "resource_count": 2, "checkov_version": "3.2.21"}}, {"check_type": "dockerfile", "results": {"failed_checks": [{"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "FAILED", "results_configuration": null}, "code_block": null, "file_path": "/Dockerfile", "file_abs_path": "/code/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 7], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "FAILED", "results_configuration": null}, "code_block": null, "file_path": "/Dockerfile", "file_abs_path": "/code/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 7], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created", "details": [], "check_len": null, "definition_context_file_path": null}]}, "summary": {"passed": 23, "failed": 2, "skipped": 0, "parsing_errors": 0, "resource_count": 1, "checkov_version": "3.2.21"}}, {"check_type": "circleci_pipelines", "results": {"failed_checks": [{"check_id": "CKV_CIRCLECIPIPELINES_2", "bc_check_id": null, "check_name": "Ensure the pipeline image version is referenced via hash not arbitrary tag.", "check_result": {"result": "FAILED", "results_configuration": {"image": "ghcr.io/bridgecrewio/checkov:3.2.21", "__startline__": 6, "__endline__": 10}}, "code_block": null, "file_path": "/.circleci/config.yml", "file_abs_path": "/code/.circleci/config.yml", "repo_file_path": "/.circleci/config.yml", "file_line_range": [6, 11], "resource": "jobs(iac-scan).docker.image[1](ghcr.io/bridgecrewio/checkov:3.2.21)", "evaluations": null, "check_class": "checkov.circleci_pipelines.checks.image_version_not_hash", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_CIRCLECIPIPELINES_7", "bc_check_id": null, "check_name": "Suspicious use of curl in run task", "check_result": {"result": "FAILED", "results_configuration": {"run": {"name": "Uploading Results", "command": "curl --location --request POST \"https://${ACCUKNOX_ENDPOINT}/api/v1/artifact/?tenant_id=${ACCUKNOX_TENANT}&data_type=TR&label_id=${LABEL}&save_to_s3=false\" --header \"Tenant-Id: ${ACCUKNOX_TENANT}\" --header \"Authorization: Bearer ${TOKEN}\" --form 'file=@\"results.json\"'\n", "__startline__": 22, "__endline__": 25}, "__startline__": 21, "__endline__": 25}}, "code_block": null, "file_path": "/.circleci/config.yml", "file_abs_path": "/code/.circleci/config.yml", "repo_file_path": "/.circleci/config.yml", "file_line_range": [21, 26], "resource": "jobs(iac-scan).steps[1](checkout)", "evaluations": null, "check_class": "checkov.circleci_pipelines.checks.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null}]}, "summary": {"passed": 13, "failed": 2, "skipped": 0, "parsing_errors": 0, "resource_count": 0, "checkov_version": "3.2.21"}}]